#!/bin/bash
############# https://github.com/plexguide/PlexGuide.com/graphs/contributors ###
apps_menu() {

apps_interface_start

personal_blank () {
  if [[ $(ls /pg/mods/containers/personal) == "" ]]; then
  common_header "⛔️ WARNING! No Personnal Apps Detected! - plexguide.com/wiki/no-apps"
  common_confirm
  apps_menu && exit; fi
}

app_repos () {
common_message "🚀  Default App Repos" "💬 More Info? Visit ~ plexguide.com/wiki/app-repos

[1] Personal - $personal1/$personal2
[Z] Exit"

common_number

case $typed in
    1 ) apps_repos_change && apps_menu && exit ;;
    z ) apps_menu && exit ;;
    Z ) apps_menu && exit ;;
    * ) apps_repos && exit ;;
esac

}

apps_repos_git () {
common_message "🚀  Repo Information" "TIP: Ensure that you forked the personal repo via
github.com/plexguide/personal. From here, all we need is your username.

What is your GITHUB username?"
common_number
apps_repos_set

abc=$typed
common_header "💬 $abc/personal <<< Is this repo correct [Y/N]? [Z] To Exit!"
common_number
case $typed in
    y ) a=a ;;
    Y ) a=a ;;
    n ) apps_repos_git && exit ;;
    N ) apps_repos_git && exit ;;
    z ) apps_menu && exit ;;
    Z ) apps_menu && exit ;;
    * ) apps_repos_git && exit ;;
esac

echo $abc > /pg/var/repos/repo.personal1

common_header "💬 $abc/personal is now set as the personal repo!"
common_confirm

apps_menu && exit
}

apps_repos_change () {

repo1=$(cat /pg/var/repos/repo.personal1)
repo2=$(cat /pg/var/repos/repo.personal2)

common_message "🚀  Change Default App Repos" "💬 Current Repo: $repo1/$repo2

Change the Following Repo? [y/n]"

common_number

case $typed in
    y ) apps_repos_git && exit ;;
    Y ) apps_repos_git && exit ;;
    n ) apps_repos_change && exit ;;
    N ) apps_repos_change && exit ;;
    * ) apps_repos_change && exit ;;
esac
}

common_message "🚀  PG Applications Interface" "💬 More Info? Visit ~ plexguide.com/wiki/apps

[1] Primary
[2] Community
[3] Personal
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[C] Change Default App Repos
[D] Default Settings
[S] Shield Setup
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[Z] Exit Interface"

common_number

rm -rf /pg/tmp/appstoinstall.list && touch /pg/tmp/appstoinstall.list
touch /pg/tmp/list.tmp
case $typed in
    1 ) sapp="primary" && ls -p /pg/mods/containers/$sapp/ | grep -v / > "/pg/tmp/list.tmp" && apps_interface ;;
    2 ) sapp="community" && ls -p /pg/mods/containers/$sapp/ | grep -v / > "/pg/tmp/list.tmp" && apps_interface ;;
    3 ) personal_blank && sapp="personal" && ls -p /pg/mods/containers/$sapp/ | grep -v / > "/pg/tmp/list.tmp" && apps_interface ;;
    C ) app_repos && exit ;;
    c ) app_repos && exit ;;
    d ) apps_default_interface ;;
    D ) apps_default_interface ;;
    s ) shield_setup ;;
    S ) shield_setup ;;
    z ) start_menu ;;
    Z ) start_menu ;;
    * ) apps_menu ;;
esac

}
