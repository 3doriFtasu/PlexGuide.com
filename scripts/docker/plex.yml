---
version: '2'
services:
    plex:
        container_name: plex
        image: plexinc/pms-docker:${PMS_TAG}
        restart: unless-stopped
        network_mode: "host"
        ports:
            - '${IP_ADDRESS}:32400:32400/tcp'
            - '${IP_ADDRESS}:3005:3005/tcp'
            - '${IP_ADDRESS}:8324:8324/tcp'
            - '${IP_ADDRESS}:32469:32469/tcp'
            - '${IP_ADDRESS}:1900:1900/udp'
            - '${IP_ADDRESS}:32410:32410/udp'
            - '${IP_ADDRESS}:32412:32412/udp'
            - '${IP_ADDRESS}:32413:32413/udp'
            - '${IP_ADDRESS}:32414:32414/udp'
#        env_file:
 #           - /opt/.environments/.plex-env
        environment:
            - PLEX_CLAIM=${PMS_TOKEN}
            - ADVERTISE_IP=http://${IP_ADDRESS}:32400/
            - ALLOWED_NETWORKS=${CIDR_ADDRESS}
  #          - PLEX_UID=${PUID}
  #          - PLEX_GID=${PGID}
            - PUID=1000
            - PGID=1000
        hostname: ${HOSTNAME}
        volumes:
            - /opt/plex/database:/config
            - /opt/plex/transcode:/transcode
            - /mnt/plexdrive4:/plexdrive4
            - /mnt/unionfs:/unionfs
            - /:/yourcomputer
            - /etc/localtime:/etc/localtime:ro
