---
- name: Remove Ubooquity Container
  docker_container:
    name: ubooquity
    state: absent

- name: Deploy Ubooquity Container
  docker_container:
    name: ubooquity
    image: linuxserver/ubooquity:latest
    pull: yes
    cpu_shares: 256
    published_ports:
    - "{{ports}}2202:2202"
    - "2203:2203"
    env:
      APP: ubooquity
      VERSION: stable
      PUID: "1000"
      PGID: "1000"
    networks:
      - name: plexguide
        aliases:
          - ubooquity
    volumes:
    - /opt/appdata/ubooquity:/config
    - /mnt/unionfs/plexguide/ubooquity/books:/books
    - /mnt/unionfs/plexguide/ubooquity/comics:/comics
    - /mnt/unionfs/plexguide/ubooquity/raw:/files
    - /etc/localtime:/etc/localtime:ro
    restart_policy: always
    state: started
    labels:
      traefik.enable: "true"
      traefik.frontend.rule: "Host:ubooquity.{{domain}}"
      traefik.port: "2202"
